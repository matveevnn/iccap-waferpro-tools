<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>testfile.mdm</title>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <style>
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #fafafa;
            --bg-tertiary: #f5f5f5;
            --bg-card: #ffffff;
            --border-color: #eeeeee;
            --text-primary: #333333;
            --text-secondary: #666666;
            --text-muted: #999999;
            --accent-blue: #0066cc;
            --accent-green: #22863a;
            --accent-orange: #e36209;
            --accent-red: #cb2431;
            --font-family: 'Inter', 'Segoe UI', system-ui, sans-serif;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: var(--font-family);
            background: var(--bg-primary);
            min-height: 100vh;
            color: var(--text-primary);
            line-height: 1.6;
            font-size: 14px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 1.5rem 2rem;
        }
        
        header {
            text-align: left;
            padding: 1rem 0 1.5rem;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 1.5rem;
        }
        
        h1 {
            font-size: 1.25rem;
            font-weight: 500;
            color: var(--text-primary);
        }
        
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        @media (max-width: 1200px) {
            .grid {
                grid-template-columns: 1fr;
            }
        }
        
        .card {
            background: var(--bg-card);
            padding: 0;
        }
        
        .card-title {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-muted);
            margin-bottom: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .regime-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }
        
        .regime-table th {
            color: var(--text-muted);
            font-weight: 500;
            padding: 0.5rem 0.75rem;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
            font-size: 12px;
        }
        
        .regime-table td {
            padding: 0.5rem 0.75rem;
            border-bottom: 1px solid var(--border-color);
            color: var(--text-primary);
        }
        
        .regime-table tr:last-child td {
            border-bottom: none;
        }
        
        .var-name {
            color: var(--text-primary);
            font-weight: 500;
        }
        
        .var-unit {
            color: var(--text-muted);
        }
        
        .var-node {
            color: var(--text-primary);
        }
        
        .var-smu {
            color: var(--text-secondary);
        }
        
        .var-sweep {
            color: var(--text-secondary);
        }
        
        .metadata-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
        }
        
        .metadata-item {
            display: flex;
            gap: 0.5rem;
            align-items: baseline;
        }
        
        .metadata-label {
            font-size: 12px;
            color: var(--text-muted);
        }
        
        .metadata-value {
            color: var(--text-primary);
            font-size: 13px;
        }
        
        .graph-section {
            margin: 1.5rem 0;
            padding-top: 1.5rem;
            border-top: 1px solid var(--border-color);
        }
        
        .graph-card {
            background: var(--bg-card);
        }
        
        .graph-controls {
            padding: 0 0 1rem 0;
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            align-items: flex-start;
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }
        
        .control-label {
            font-size: 11px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }
        
        select {
            font-family: var(--font-family);
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 0.4rem 0.6rem;
            border-radius: 4px;
            font-size: 13px;
            cursor: pointer;
            min-width: 120px;
        }
        
        select:hover {
            border-color: var(--text-muted);
        }
        
        select:focus {
            outline: none;
            border-color: var(--accent-blue);
        }
        
        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }
        
        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 0.25rem;
            cursor: pointer;
        }
        
        .checkbox-item input {
            cursor: pointer;
            accent-color: #000000;
        }
        
        .checkbox-item label {
            cursor: pointer;
            font-size: 13px;
            color: var(--text-muted);
            transition: color 0.15s;
        }
        
        .checkbox-item input:checked + label {
            color: #000000;
            font-weight: 500;
        }
        
        #plot {
            width: 100%;
            height: 600px;
        }
        
        .data-table-section {
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--border-color);
        }
        
        .data-table-card {
            background: var(--bg-card);
        }
        
        .table-header {
            padding: 0 0 1rem 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .table-title {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }
        
        .table-container {
            overflow-x: auto;
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid var(--border-color);
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
        }
        
        .data-table th {
            background: var(--bg-secondary);
            color: var(--text-muted);
            font-weight: 500;
            padding: 0.5rem 0.75rem;
            text-align: right;
            border-bottom: 1px solid var(--border-color);
            position: sticky;
            top: 0;
            z-index: 10;
            font-size: 11px;
        }
        
        .data-table th:first-child {
            text-align: center;
        }
        
        .data-table td {
            padding: 0.35rem 0.75rem;
            border-bottom: 1px solid var(--border-color);
            text-align: right;
            color: var(--text-primary);
        }
        
        .data-table td:first-child {
            text-align: center;
            color: var(--text-muted);
        }
        
        .data-table tr:last-child td {
            border-bottom: none;
        }
        
        .plot-type-btns {
            display: flex;
            gap: 2px;
        }
        
        .plot-type-btn {
            font-family: var(--font-family);
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
            padding: 0.4rem 0.6rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .plot-type-btn:hover {
            border-color: var(--text-muted);
        }
        
        .plot-type-btn.active {
            background: var(--text-primary);
            color: var(--bg-primary);
            border-color: var(--text-primary);
        }
        
        .action-btn {
            font-family: var(--font-family);
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
            padding: 0.4rem 0.75rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .action-btn:hover {
            border-color: var(--text-muted);
            color: var(--text-primary);
        }
        
        .action-btn.success {
            background: var(--accent-green);
            color: white;
            border-color: var(--accent-green);
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>testfile.mdm</h1>
        </header>
        
        <div class="grid">
            <div class="card">
                <h2 class="card-title">INPUTS</h2>
                <table class="regime-table">
                    <thead>
                        <tr>
                            <th>Variable</th>
                            <th>Unit</th>
                            <th>Node</th>
                            <th>SMU</th>
                            <th>Sweep</th>
                            <th>Option</th>
                        </tr>
                    </thead>
                    <tbody id="inputs-table"></tbody>
                </table>
            </div>
            
            <div class="card">
                <h2 class="card-title">OUTPUTS</h2>
                <table class="regime-table">
                    <thead>
                        <tr>
                            <th>Variable</th>
                            <th>Unit</th>
                            <th>Node</th>
                            <th>SMU</th>
                            <th>Option</th>
                        </tr>
                    </thead>
                    <tbody id="outputs-table"></tbody>
                </table>
            </div>
        </div>
        
        <div class="card" style="margin-bottom: 1.5rem;">
            <h2 class="card-title">MEASUREMENT INFO</h2>
            <div class="metadata-grid" id="metadata-grid"></div>
        </div>
        
        <section class="graph-section">
            <div class="graph-card">
                <div class="graph-controls">
                    <div class="control-group">
                        <span class="control-label">X-Axis</span>
                        <select id="x-axis-select"></select>
                    </div>
                    <div class="control-group">
                        <span class="control-label">Y-Axis</span>
                        <div class="checkbox-group" id="y-axis-checkboxes"></div>
                    </div>
                    <div class="control-group">
                        <span class="control-label">X Scale</span>
                        <div class="plot-type-btns" id="x-scale-btns">
                            <button class="plot-type-btn active" data-scale="linear">Linear</button>
                            <button class="plot-type-btn" data-scale="log">Log</button>
                        </div>
                    </div>
                    <div class="control-group">
                        <span class="control-label">Y Scale</span>
                        <div class="plot-type-btns" id="y-scale-btns">
                            <button class="plot-type-btn active" data-scale="linear">Linear</button>
                            <button class="plot-type-btn" data-scale="log">Log</button>
                        </div>
                    </div>
                    <div class="control-group">
                        <span class="control-label">Sweep</span>
                        <select id="block-select">
                            <option value="all">All</option>
                        </select>
                    </div>
                    <div class="control-group" style="margin-left: auto;">
                        <button class="action-btn" id="save-plot-btn">Save PNG</button>
                    </div>
                </div>
                <div id="plot"></div>
            </div>
        </section>
        
        <section class="data-table-section">
            <div class="data-table-card">
                <div class="table-header">
                    <h2 class="table-title">Measurement Data</h2>
                    <div style="display: flex; align-items: center; gap: 1rem;">
                        <div class="control-group">
                            <select id="table-block-select">
                                <option value="all">All</option>
                            </select>
                        </div>
                        <button class="action-btn" id="copy-table-btn">Copy Data</button>
                    </div>
                </div>
                <div class="table-container">
                    <table class="data-table">
                        <thead id="table-head"></thead>
                        <tbody id="table-body"></tbody>
                    </table>
                </div>
            </div>
        </section>
        
        <section class="data-table-section">
            <div class="data-table-card">
                <div class="table-header" style="flex-direction: column; align-items: flex-start; gap: 0.5rem;">
                    <h2 class="table-title">Link to mdm file</h2>
                    <a href=" " style="color: var(--accent-blue); text-decoration: none; font-size: 0.875rem;"> </a>
                </div>
            </div>
        </section>
    </div>
    
    <script>
        // Data from MDM file
        const mdmData = [
  {
    "index": 0,
    "vars": {
      "vb": -2.5,
      "vs": 0.0,
      "vg": 1.342
    },
    "columns": [
      "vd",
      "id",
      "ig",
      "is",
      "ib"
    ],
    "data": [
      {
        "vd": 0.0,
        "id": 9.61103663412e-15,
        "ig": 0.0,
        "is": 9.9013906046e-15,
        "ib": 0.0
      },
      {
        "vd": 0.05,
        "id": 1.35715460531e-05,
        "ig": 0.0,
        "is": -1.39815815868e-05,
        "ib": 0.0
      },
      {
        "vd": 0.1,
        "id": 2.38959096477e-05,
        "ig": 0.0,
        "is": -2.46179316186e-05,
        "ib": 0.0
      },
      {
        "vd": 0.15,
        "id": 3.10475397953e-05,
        "ig": 0.0,
        "is": -3.19857252379e-05,
        "ib": 0.0
      },
      {
        "vd": 0.2,
        "id": 3.52522406571e-05,
        "ig": 0.0,
        "is": -3.63175675564e-05,
        "ib": 0.0
      },
      {
        "vd": 0.25,
        "id": 3.71596420429e-05,
        "ig": 0.0,
        "is": -3.82827004304e-05,
        "ib": 0.0
      },
      {
        "vd": 0.3,
        "id": 3.78483518405e-05,
        "ig": 0.0,
        "is": -3.89923160123e-05,
        "ib": 0.0
      },
      {
        "vd": 0.35,
        "id": 3.81072838412e-05,
        "ig": 0.0,
        "is": -3.92591661513e-05,
        "ib": 0.0
      },
      {
        "vd": 0.4,
        "id": 3.82314567534e-05,
        "ig": 0.0,
        "is": -3.93871846648e-05,
        "ib": 0.0
      },
      {
        "vd": 0.45,
        "id": 3.83079175707e-05,
        "ig": 0.0,
        "is": -3.94660492623e-05,
        "ib": 0.0
      },
      {
        "vd": 0.5,
        "id": 3.83644639015e-05,
        "ig": 0.0,
        "is": -3.95243976126e-05,
        "ib": 0.0
      },
      {
        "vd": 0.55,
        "id": 3.84114659648e-05,
        "ig": 0.0,
        "is": -3.95729133506e-05,
        "ib": 0.0
      },
      {
        "vd": 0.6,
        "id": 3.84533776402e-05,
        "ig": 0.0,
        "is": -3.96161851434e-05,
        "ib": 0.0
      },
      {
        "vd": 0.65,
        "id": 3.84923413172e-05,
        "ig": 0.0,
        "is": -3.9656419918e-05,
        "ib": 0.0
      },
      {
        "vd": 0.7,
        "id": 3.85294838726e-05,
        "ig": 0.0,
        "is": -3.96947783892e-05,
        "ib": 0.0
      },
      {
        "vd": 0.75,
        "id": 3.85654409494e-05,
        "ig": 0.0,
        "is": -3.97319161848e-05,
        "ib": 0.0
      },
      {
        "vd": 0.8,
        "id": 3.86005942172e-05,
        "ig": 0.0,
        "is": -3.97682256928e-05,
        "ib": 0.0
      },
      {
        "vd": 0.85,
        "id": 3.86351823558e-05,
        "ig": 0.0,
        "is": -3.98039532169e-05,
        "ib": 0.0
      },
      {
        "vd": 0.9,
        "id": 3.8669361572e-05,
        "ig": 0.0,
        "is": -3.98392596483e-05,
        "ib": 0.0
      },
      {
        "vd": 0.95,
        "id": 3.87032373875e-05,
        "ig": 0.0,
        "is": -3.98742536932e-05,
        "ib": 0.0
      },
      {
        "vd": 1.0,
        "id": 3.87368834268e-05,
        "ig": 0.0,
        "is": -3.99090109555e-05,
        "ib": 0.0
      },
      {
        "vd": 1.05,
        "id": 3.87703514675e-05,
        "ig": 0.0,
        "is": -3.99435853511e-05,
        "ib": 0.0
      },
      {
        "vd": 1.1,
        "id": 3.88036799605e-05,
        "ig": 0.0,
        "is": -3.99780161816e-05,
        "ib": 0.0
      },
      {
        "vd": 1.15,
        "id": 3.88368979623e-05,
        "ig": 0.0,
        "is": -4.00123326537e-05,
        "ib": 0.0
      },
      {
        "vd": 1.2,
        "id": 3.88700253538e-05,
        "ig": 0.0,
        "is": -4.00465568474e-05,
        "ib": 0.0
      },
      {
        "vd": 1.25,
        "id": 3.89030800495e-05,
        "ig": 0.0,
        "is": -4.00807057127e-05,
        "ib": 0.0
      },
      {
        "vd": 1.3,
        "id": 3.89360740653e-05,
        "ig": 0.0,
        "is": -4.01147924423e-05,
        "ib": 0.0
      },
      {
        "vd": 1.35,
        "id": 3.89690181062e-05,
        "ig": 0.0,
        "is": -4.01488274345e-05,
        "ib": 0.0
      },
      {
        "vd": 1.4,
        "id": 3.90019196003e-05,
        "ig": 0.0,
        "is": -4.018281898e-05,
        "ib": 0.0
      },
      {
        "vd": 1.45,
        "id": 3.9034784883e-05,
        "ig": 0.0,
        "is": -4.02167737633e-05,
        "ib": 0.0
      },
      {
        "vd": 1.5,
        "id": 3.90676198531e-05,
        "ig": 0.0,
        "is": -4.02506972335e-05,
        "ib": 0.0
      },
      {
        "vd": 1.55,
        "id": 3.91004284431e-05,
        "ig": 0.0,
        "is": -4.02845938863e-05,
        "ib": 0.0
      },
      {
        "vd": 1.6,
        "id": 3.91332148039e-05,
        "ig": 0.0,
        "is": -4.03184674842e-05,
        "ib": 0.0
      },
      {
        "vd": 1.65,
        "id": 3.91659817755e-05,
        "ig": 0.0,
        "is": -4.03523212342e-05,
        "ib": 0.0
      },
      {
        "vd": 1.7,
        "id": 3.9198732198e-05,
        "ig": 0.0,
        "is": -4.0386157938e-05,
        "ib": 0.0
      },
      {
        "vd": 1.75,
        "id": 3.92314680377e-05,
        "ig": 0.0,
        "is": -4.04199801251e-05,
        "ib": 0.0
      },
      {
        "vd": 1.8,
        "id": 3.92641919162e-05,
        "ig": 0.0,
        "is": -4.04537901762e-05,
        "ib": 0.0
      },
      {
        "vd": 1.85,
        "id": 3.9296906018e-05,
        "ig": 0.0,
        "is": -4.04875904439e-05,
        "ib": 0.0
      },
      {
        "vd": 1.9,
        "id": 3.93296129647e-05,
        "ig": 0.0,
        "is": -4.05213833738e-05,
        "ib": 0.0
      },
      {
        "vd": 1.95,
        "id": 3.93623158148e-05,
        "ig": 0.0,
        "is": -4.05551716293e-05,
        "ib": 0.0
      },
      {
        "vd": 2.0,
        "id": 3.93950165342e-05,
        "ig": 0.0,
        "is": -4.05889582225e-05,
        "ib": 0.0
      },
      {
        "vd": 2.05,
        "id": 3.94277181814e-05,
        "ig": 0.0,
        "is": -4.06227466508e-05,
        "ib": 0.0
      },
      {
        "vd": 2.1,
        "id": 3.94604264361e-05,
        "ig": 0.0,
        "is": -4.06565410411e-05,
        "ib": 0.0
      },
      {
        "vd": 2.15,
        "id": 3.94931441381e-05,
        "ig": 0.0,
        "is": -4.06903462989e-05,
        "ib": 0.0
      },
      {
        "vd": 2.2,
        "id": 3.95258791516e-05,
        "ig": 0.0,
        "is": -4.07241682634e-05,
        "ib": 0.0
      },
      {
        "vd": 2.25,
        "id": 3.95586362824e-05,
        "ig": 0.0,
        "is": -4.07580138658e-05,
        "ib": 0.0
      },
      {
        "vd": 2.3,
        "id": 3.95914242682e-05,
        "ig": 0.0,
        "is": -4.07918912893e-05,
        "ib": 0.0
      },
      {
        "vd": 2.35,
        "id": 3.96242518469e-05,
        "ig": 0.0,
        "is": -4.08258101294e-05,
        "ib": 0.0
      },
      {
        "vd": 2.4,
        "id": 3.96571308144e-05,
        "ig": 0.0,
        "is": -4.08597815523e-05,
        "ib": 0.0
      },
      {
        "vd": 2.45,
        "id": 3.96900725295e-05,
        "ig": 0.0,
        "is": -4.0893818449e-05,
        "ib": 0.0
      },
      {
        "vd": 2.5,
        "id": 3.97230927201e-05,
        "ig": 0.0,
        "is": -4.09279355842e-05,
        "ib": 0.0
      }
    ]
  },
  {
    "index": 1,
    "vars": {
      "vb": -2.5,
      "vs": 0.0,
      "vg": 1.5736
    },
    "columns": [
      "vd",
      "id",
      "ig",
      "is",
      "ib"
    ],
    "data": [
      {
        "vd": 0.0,
        "id": 9.60980757177e-15,
        "ig": 0.0,
        "is": 9.90130628353e-15,
        "ib": 0.0
      },
      {
        "vd": 0.05,
        "id": 3.06398813049e-05,
        "ig": 0.0,
        "is": -3.15693688029e-05,
        "ib": 0.0
      },
      {
        "vd": 0.1,
        "id": 5.77144509123e-05,
        "ig": 0.0,
        "is": -5.94654082378e-05,
        "ib": 0.0
      },
      {
        "vd": 0.15,
        "id": 8.12397083226e-05,
        "ig": 0.0,
        "is": -8.37045774969e-05,
        "ib": 0.0
      },
      {
        "vd": 0.2,
        "id": 0.000101235345714,
        "ig": 0.0,
        "is": -0.000104307140675,
        "ib": 0.0
      },
      {
        "vd": 0.25,
        "id": 0.000117729108199,
        "ig": 0.0,
        "is": -0.000121301659047,
        "ib": 0.0
      },
      {
        "vd": 0.3,
        "id": 0.000130767651441,
        "ig": 0.0,
        "is": -0.000134736179033,
        "ib": 0.0
      },
      {
        "vd": 0.35,
        "id": 0.000140445037281,
        "ig": 0.0,
        "is": -0.000144707592258,
        "ib": 0.0
      },
      {
        "vd": 0.4,
        "id": 0.000146975197775,
        "ig": 0.0,
        "is": -0.000151436299912,
        "ib": 0.0
      },
      {
        "vd": 0.45,
        "id": 0.000150830588176,
        "ig": 0.0,
        "is": -0.000155409075772,
        "ib": 0.0
      },
      {
        "vd": 0.5,
        "id": 0.000152813823484,
        "ig": 0.0,
        "is": -0.000157452881081,
        "ib": 0.0
      },
      {
        "vd": 0.55,
        "id": 0.000153781758308,
        "ig": 0.0,
        "is": -0.00015845057094,
        "ib": 0.0
      },
      {
        "vd": 0.6,
        "id": 0.000154292240196,
        "ig": 0.0,
        "is": -0.000158976923335,
        "ib": 0.0
      },
      {
        "vd": 0.65,
        "id": 0.00015460462339,
        "ig": 0.0,
        "is": -0.000159299164055,
        "ib": 0.0
      },
      {
        "vd": 0.7,
        "id": 0.000154826067037,
        "ig": 0.0,
        "is": -0.000159527705152,
        "ib": 0.0
      },
      {
        "vd": 0.75,
        "id": 0.000155001922684,
        "ig": 0.0,
        "is": -0.000159709275038,
        "ib": 0.0
      },
      {
        "vd": 0.8,
        "id": 0.000155152897864,
        "ig": 0.0,
        "is": -0.000159865209578,
        "ib": 0.0
      },
      {
        "vd": 0.85,
        "id": 0.00015528926535,
        "ig": 0.0,
        "is": -0.000160006093486,
        "ib": 0.0
      },
      {
        "vd": 0.9,
        "id": 0.000155416520586,
        "ig": 0.0,
        "is": -0.000160137588697,
        "ib": 0.0
      },
      {
        "vd": 0.95,
        "id": 0.00015553779919,
        "ig": 0.0,
        "is": -0.00016026292628,
        "ib": 0.0
      },
      {
        "vd": 1.0,
        "id": 0.000155654990898,
        "ig": 0.0,
        "is": -0.000160384053778,
        "ib": 0.0
      },
      {
        "vd": 1.05,
        "id": 0.000155769289493,
        "ig": 0.0,
        "is": -0.000160502200644,
        "ib": 0.0
      },
      {
        "vd": 1.1,
        "id": 0.000155881478303,
        "ig": 0.0,
        "is": -0.000160618174121,
        "ib": 0.0
      },
      {
        "vd": 1.15,
        "id": 0.000155992088796,
        "ig": 0.0,
        "is": -0.000160732522367,
        "ib": 0.0
      },
      {
        "vd": 1.2,
        "id": 0.000156101493851,
        "ig": 0.0,
        "is": -0.000160845628575,
        "ib": 0.0
      },
      {
        "vd": 1.25,
        "id": 0.000156209959746,
        "ig": 0.0,
        "is": -0.000160957767471,
        "ib": 0.0
      },
      {
        "vd": 1.3,
        "id": 0.00015631768155,
        "ig": 0.0,
        "is": -0.00016106914042,
        "ib": 0.0
      },
      {
        "vd": 1.35,
        "id": 0.000156424805399,
        "ig": 0.0,
        "is": -0.000161179897928,
        "ib": 0.0
      },
      {
        "vd": 1.4,
        "id": 0.000156531442698,
        "ig": 0.0,
        "is": -0.000161290154457,
        "ib": 0.0
      },
      {
        "vd": 1.45,
        "id": 0.000156637679513,
        "ig": 0.0,
        "is": -0.000161399998412,
        "ib": 0.0
      },
      {
        "vd": 1.5,
        "id": 0.000156743581813,
        "ig": 0.0,
        "is": -0.000161509499033,
        "ib": 0.0
      },
      {
        "vd": 1.55,
        "id": 0.000156849204425,
        "ig": 0.0,
        "is": -0.000161618711239,
        "ib": 0.0
      },
      {
        "vd": 1.6,
        "id": 0.000156954588855,
        "ig": 0.0,
        "is": -0.000161727679096,
        "ib": 0.0
      },
      {
        "vd": 1.65,
        "id": 0.000157059770707,
        "ig": 0.0,
        "is": -0.000161836438343,
        "ib": 0.0
      },
      {
        "vd": 1.7,
        "id": 0.00015716477816,
        "ig": 0.0,
        "is": -0.000161945018271,
        "ib": 0.0
      },
      {
        "vd": 1.75,
        "id": 0.000157269634151,
        "ig": 0.0,
        "is": -0.000162053443145,
        "ib": 0.0
      },
      {
        "vd": 1.8,
        "id": 0.000157374359431,
        "ig": 0.0,
        "is": -0.000162161733298,
        "ib": 0.0
      },
      {
        "vd": 1.85,
        "id": 0.000157478969728,
        "ig": 0.0,
        "is": -0.000162269906014,
        "ib": 0.0
      },
      {
        "vd": 1.9,
        "id": 0.000157583480552,
        "ig": 0.0,
        "is": -0.000162377976251,
        "ib": 0.0
      },
      {
        "vd": 1.95,
        "id": 0.000157687903916,
        "ig": 0.0,
        "is": -0.000162485957262,
        "ib": 0.0
      },
      {
        "vd": 2.0,
        "id": 0.000157792252271,
        "ig": 0.0,
        "is": -0.000162593861164,
        "ib": 0.0
      },
      {
        "vd": 2.05,
        "id": 0.000157896536757,
        "ig": 0.0,
        "is": -0.000162701699462,
        "ib": 0.0
      },
      {
        "vd": 2.1,
        "id": 0.000158000766768,
        "ig": 0.0,
        "is": -0.000162809483569,
        "ib": 0.0
      },
      {
        "vd": 2.15,
        "id": 0.000158104956501,
        "ig": 0.0,
        "is": -0.000162917225331,
        "ib": 0.0
      },
      {
        "vd": 2.2,
        "id": 0.000158209116877,
        "ig": 0.0,
        "is": -0.000163024937562,
        "ib": 0.0
      },
      {
        "vd": 2.25,
        "id": 0.000158313261876,
        "ig": 0.0,
        "is": -0.000163132634602,
        "ib": 0.0
      },
      {
        "vd": 2.3,
        "id": 0.000158417408098,
        "ig": 0.0,
        "is": -0.000163240332899,
        "ib": 0.0
      },
      {
        "vd": 2.35,
        "id": 0.000158521572143,
        "ig": 0.0,
        "is": -0.000163348051607,
        "ib": 0.0
      },
      {
        "vd": 2.4,
        "id": 0.000158625778911,
        "ig": 0.0,
        "is": -0.000163455813216,
        "ib": 0.0
      },
      {
        "vd": 2.45,
        "id": 0.000158730051991,
        "ig": 0.0,
        "is": -0.00016356364418,
        "ib": 0.0
      },
      {
        "vd": 2.5,
        "id": 0.000158834421961,
        "ig": 0.0,
        "is": -0.000163671575574,
        "ib": 0.0
      }
    ]
  },
  {
    "index": 2,
    "vars": {
      "vb": -2.5,
      "vs": 0.0,
      "vg": 1.8052
    },
    "columns": [
      "vd",
      "id",
      "ig",
      "is",
      "ib"
    ],
    "data": [
      {
        "vd": 0.0,
        "id": 9.60857850942e-15,
        "ig": 0.0,
        "is": 9.90122196246e-15,
        "ib": 0.0
      },
      {
        "vd": 0.05,
        "id": 4.63144871234e-05,
        "ig": 0.0,
        "is": -4.77251749701e-05,
        "ib": 0.0
      },
      {
        "vd": 0.1,
        "id": 8.90486694415e-05,
        "ig": 0.0,
        "is": -9.1761207874e-05,
        "ib": 0.0
      },
      {
        "vd": 0.15,
        "id": 0.000128214777555,
        "ig": 0.0,
        "is": -0.000132120675958,
        "ib": 0.0
      },
      {
        "vd": 0.2,
        "id": 0.000163825503622,
        "ig": 0.0,
        "is": -0.000168816632235,
        "ib": 0.0
      },
      {
        "vd": 0.25,
        "id": 0.000195894328571,
        "ig": 0.0,
        "is": -0.000201862942604,
        "ib": 0.0
      },
      {
        "vd": 0.3,
        "id": 0.000224436114407,
        "ig": 0.0,
        "is": -0.000231274896464,
        "ib": 0.0
      },
      {
        "vd": 0.35,
        "id": 0.000249468228151,
        "ig": 0.0,
        "is": -0.000257070364324,
        "ib": 0.0
      },
      {
        "vd": 0.4,
        "id": 0.000271012778355,
        "ig": 0.0,
        "is": -0.000279272103413,
        "ib": 0.0
      },
      {
        "vd": 0.45,
        "id": 0.000289101303469,
        "ig": 0.0,
        "is": -0.000297912587825,
        "ib": 0.0
      },
      {
        "vd": 0.5,
        "id": 0.000303785037843,
        "ig": 0.0,
        "is": -0.000313044588745,
        "ib": 0.0
      },
      {
        "vd": 0.55,
        "id": 0.000315157866216,
        "ig": 0.0,
        "is": -0.000324764828131,
        "ib": 0.0
      },
      {
        "vd": 0.6,
        "id": 0.000323405242469,
        "ig": 0.0,
        "is": -0.000333264389427,
        "ib": 0.0
      },
      {
        "vd": 0.65,
        "id": 0.000328887592341,
        "ig": 0.0,
        "is": -0.000338914664686,
        "ib": 0.0
      },
      {
        "vd": 0.7,
        "id": 0.000332204559331,
        "ig": 0.0,
        "is": -0.000342333559946,
        "ib": 0.0
      },
      {
        "vd": 0.75,
        "id": 0.00033409516861,
        "ig": 0.0,
        "is": -0.000344282620511,
        "ib": 0.0
      },
      {
        "vd": 0.8,
        "id": 0.000335189089233,
        "ig": 0.0,
        "is": -0.000345410706485,
        "ib": 0.0
      },
      {
        "vd": 0.85,
        "id": 0.000335876346384,
        "ig": 0.0,
        "is": -0.000346119731943,
        "ib": 0.0
      },
      {
        "vd": 0.9,
        "id": 0.000336357202079,
        "ig": 0.0,
        "is": -0.000346616064085,
        "ib": 0.0
      },
      {
        "vd": 0.95,
        "id": 0.000336728576871,
        "ig": 0.0,
        "is": -0.000346999578005,
        "ib": 0.0
      },
      {
        "vd": 1.0,
        "id": 0.000337038234403,
        "ig": 0.0,
        "is": -0.000347319494296,
        "ib": 0.0
      },
      {
        "vd": 1.05,
        "id": 0.000337310922913,
        "ig": 0.0,
        "is": -0.000347601314682,
        "ib": 0.0
      },
      {
        "vd": 1.1,
        "id": 0.000337560224655,
        "ig": 0.0,
        "is": -0.000347859036619,
        "ib": 0.0
      },
      {
        "vd": 1.15,
        "id": 0.000337794020458,
        "ig": 0.0,
        "is": -0.0003481007803,
        "ib": 0.0
      },
      {
        "vd": 1.2,
        "id": 0.000338017114282,
        "ig": 0.0,
        "is": -0.000348331496611,
        "ib": 0.0
      },
      {
        "vd": 1.25,
        "id": 0.000338232565847,
        "ig": 0.0,
        "is": -0.000348554338574,
        "ib": 0.0
      },
      {
        "vd": 1.3,
        "id": 0.000338442398735,
        "ig": 0.0,
        "is": -0.000348771391727,
        "ib": 0.0
      },
      {
        "vd": 1.35,
        "id": 0.000338647997233,
        "ig": 0.0,
        "is": -0.000348984081653,
        "ib": 0.0
      },
      {
        "vd": 1.4,
        "id": 0.000338850333708,
        "ig": 0.0,
        "is": -0.000349193411125,
        "ib": 0.0
      },
      {
        "vd": 1.45,
        "id": 0.000339050109913,
        "ig": 0.0,
        "is": -0.000349400103399,
        "ib": 0.0
      },
      {
        "vd": 1.5,
        "id": 0.000339247843702,
        "ig": 0.0,
        "is": -0.000349604691748,
        "ib": 0.0
      },
      {
        "vd": 1.55,
        "id": 0.000339443923845,
        "ig": 0.0,
        "is": -0.000349807577094,
        "ib": 0.0
      },
      {
        "vd": 1.6,
        "id": 0.000339638648255,
        "ig": 0.0,
        "is": -0.000350009066117,
        "ib": 0.0
      },
      {
        "vd": 1.65,
        "id": 0.000339832248011,
        "ig": 0.0,
        "is": -0.000350209397065,
        "ib": 0.0
      },
      {
        "vd": 1.7,
        "id": 0.000340024904829,
        "ig": 0.0,
        "is": -0.000350408757609,
        "ib": 0.0
      },
      {
        "vd": 1.75,
        "id": 0.000340216764608,
        "ig": 0.0,
        "is": -0.000350607297447,
        "ib": 0.0
      },
      {
        "vd": 1.8,
        "id": 0.000340407944854,
        "ig": 0.0,
        "is": -0.000350805137362,
        "ib": 0.0
      },
      {
        "vd": 1.85,
        "id": 0.0003405985397,
        "ig": 0.0,
        "is": -0.000351002375837,
        "ib": 0.0
      },
      {
        "vd": 1.9,
        "id": 0.000340788628868,
        "ig": 0.0,
        "is": -0.000351199093983,
        "ib": 0.0
      },
      {
        "vd": 1.95,
        "id": 0.000340978278316,
        "ig": 0.0,
        "is": -0.000351395359257,
        "ib": 0.0
      },
      {
        "vd": 2.0,
        "id": 0.000341167541993,
        "ig": 0.0,
        "is": -0.000351591228342,
        "ib": 0.0
      },
      {
        "vd": 2.05,
        "id": 0.000341356467948,
        "ig": 0.0,
        "is": -0.000351786749427,
        "ib": 0.0
      },
      {
        "vd": 2.1,
        "id": 0.000341545094841,
        "ig": 0.0,
        "is": -0.000351981964059,
        "ib": 0.0
      },
      {
        "vd": 2.15,
        "id": 0.000341733458271,
        "ig": 0.0,
        "is": -0.000352176908714,
        "ib": 0.0
      },
      {
        "vd": 2.2,
        "id": 0.000341921590564,
        "ig": 0.0,
        "is": -0.00035237161618,
        "ib": 0.0
      },
      {
        "vd": 2.25,
        "id": 0.000342109522732,
        "ig": 0.0,
        "is": -0.000352566116823,
        "ib": 0.0
      },
      {
        "vd": 2.3,
        "id": 0.000342297280986,
        "ig": 0.0,
        "is": -0.0003527604398,
        "ib": 0.0
      },
      {
        "vd": 2.35,
        "id": 0.000342484894154,
        "ig": 0.0,
        "is": -0.000352954614249,
        "ib": 0.0
      },
      {
        "vd": 2.4,
        "id": 0.000342672391938,
        "ig": 0.0,
        "is": -0.000353148670501,
        "ib": 0.0
      },
      {
        "vd": 2.45,
        "id": 0.000342859805788,
        "ig": 0.0,
        "is": -0.000353342641313,
        "ib": 0.0
      },
      {
        "vd": 2.5,
        "id": 0.000343047171085,
        "ig": 0.0,
        "is": -0.000353536563142,
        "ib": 0.0
      }
    ]
  },
  {
    "index": 3,
    "vars": {
      "vb": -2.5,
      "vs": 0.0,
      "vg": 2.0368
    },
    "columns": [
      "vd",
      "id",
      "ig",
      "is",
      "ib"
    ],
    "data": [
      {
        "vd": 0.0,
        "id": 9.60734944707e-15,
        "ig": 0.0,
        "is": 9.90113764139e-15,
        "ib": 0.0
      },
      {
        "vd": 0.05,
        "id": 6.07026027157e-05,
        "ig": 0.0,
        "is": -6.2559006007e-05,
        "ib": 0.0
      },
      {
        "vd": 0.1,
        "id": 0.000117879988389,
        "ig": 0.0,
        "is": -0.000121485271469,
        "ib": 0.0
      },
      {
        "vd": 0.15,
        "id": 0.00017154310759,
        "ig": 0.0,
        "is": -0.000176790056372,
        "ib": 0.0
      },
      {
        "vd": 0.2,
        "id": 0.000221702999858,
        "ig": 0.0,
        "is": -0.00022848471245,
        "ib": 0.0
      },
      {
        "vd": 0.25,
        "id": 0.000268370851341,
        "ig": 0.0,
        "is": -0.000276580742774,
        "ib": 0.0
      },
      {
        "vd": 0.3,
        "id": 0.000311558084237,
        "ig": 0.0,
        "is": -0.000321089893654,
        "ib": 0.0
      },
      {
        "vd": 0.35,
        "id": 0.000351276497592,
        "ig": 0.0,
        "is": -0.000362024300145,
        "ib": 0.0
      },
      {
        "vd": 0.4,
        "id": 0.00038753849816,
        "ig": 0.0,
        "is": -0.000399396723172,
        "ib": 0.0
      },
      {
        "vd": 0.45,
        "id": 0.000420357486474,
        "ig": 0.0,
        "is": -0.000433220948445,
        "ib": 0.0
      },
      {
        "vd": 0.5,
        "id": 0.000449748531454,
        "ig": 0.0,
        "is": -0.000463512481175,
        "ib": 0.0
      },
      {
        "vd": 0.55,
        "id": 0.000475729588376,
        "ig": 0.0,
        "is": -0.000490289801694,
        "ib": 0.0
      },
      {
        "vd": 0.6,
        "id": 0.000498323788654,
        "ig": 0.0,
        "is": -0.000513576724097,
        "ib": 0.0
      },
      {
        "vd": 0.65,
        "id": 0.000517563899012,
        "ig": 0.0,
        "is": -0.000533406994022,
        "ib": 0.0
      },
      {
        "vd": 0.7,
        "id": 0.000533501273129,
        "ig": 0.0,
        "is": -0.000549833512933,
        "ib": 0.0
      },
      {
        "vd": 0.75,
        "id": 0.000546223906654,
        "ig": 0.0,
        "is": -0.000562946946488,
        "ib": 0.0
      },
      {
        "vd": 0.8,
        "id": 0.000555891064893,
        "ig": 0.0,
        "is": -0.000572911413217,
        "ib": 0.0
      },
      {
        "vd": 0.85,
        "id": 0.000562788698184,
        "ig": 0.0,
        "is": -0.00058002159733,
        "ib": 0.0
      },
      {
        "vd": 0.9,
        "id": 0.000567380565028,
        "ig": 0.0,
        "is": -0.000584755438831,
        "ib": 0.0
      },
      {
        "vd": 0.95,
        "id": 0.000570277523656,
        "ig": 0.0,
        "is": -0.00058774248715,
        "ib": 0.0
      },
      {
        "vd": 1.0,
        "id": 0.000572087075671,
        "ig": 0.0,
        "is": -0.000589608837884,
        "ib": 0.0
      },
      {
        "vd": 1.05,
        "id": 0.000573266064262,
        "ig": 0.0,
        "is": -0.00059082531976,
        "ib": 0.0
      },
      {
        "vd": 1.1,
        "id": 0.000574093930542,
        "ig": 0.0,
        "is": -0.000591679929325,
        "ib": 0.0
      },
      {
        "vd": 1.15,
        "id": 0.000574724220486,
        "ig": 0.0,
        "is": -0.000592330913318,
        "ib": 0.0
      },
      {
        "vd": 1.2,
        "id": 0.00057523902565,
        "ig": 0.0,
        "is": -0.000592862878399,
        "ib": 0.0
      },
      {
        "vd": 1.25,
        "id": 0.000575683060798,
        "ig": 0.0,
        "is": -0.000593321907141,
        "ib": 0.0
      },
      {
        "vd": 1.3,
        "id": 0.000576081637666,
        "ig": 0.0,
        "is": -0.000593734086218,
        "ib": 0.0
      },
      {
        "vd": 1.35,
        "id": 0.000576449732416,
        "ig": 0.0,
        "is": -0.000594114851417,
        "ib": 0.0
      },
      {
        "vd": 1.4,
        "id": 0.000576796600703,
        "ig": 0.0,
        "is": -0.000594473741374,
        "ib": 0.0
      },
      {
        "vd": 1.45,
        "id": 0.000577128194726,
        "ig": 0.0,
        "is": -0.000594816890739,
        "ib": 0.0
      },
      {
        "vd": 1.5,
        "id": 0.000577448482469,
        "ig": 0.0,
        "is": -0.000595148388578,
        "ib": 0.0
      },
      {
        "vd": 1.55,
        "id": 0.000577760193041,
        "ig": 0.0,
        "is": -0.00059547104808,
        "ib": 0.0
      },
      {
        "vd": 1.6,
        "id": 0.000578065257586,
        "ig": 0.0,
        "is": -0.000595786859397,
        "ib": 0.0
      },
      {
        "vd": 1.65,
        "id": 0.000578365076579,
        "ig": 0.0,
        "is": -0.00059609726548,
        "ib": 0.0
      },
      {
        "vd": 1.7,
        "id": 0.000578660686894,
        "ig": 0.0,
        "is": -0.000596403335506,
        "ib": 0.0
      },
      {
        "vd": 1.75,
        "id": 0.000578952871863,
        "ig": 0.0,
        "is": -0.00059670587711,
        "ib": 0.0
      },
      {
        "vd": 1.8,
        "id": 0.00057924223509,
        "ig": 0.0,
        "is": -0.000597005510913,
        "ib": 0.0
      },
      {
        "vd": 1.85,
        "id": 0.000579529245004,
        "ig": 0.0,
        "is": -0.000597302721195,
        "ib": 0.0
      },
      {
        "vd": 1.9,
        "id": 0.000579814273723,
        "ig": 0.0,
        "is": -0.000597597891081,
        "ib": 0.0
      },
      {
        "vd": 1.95,
        "id": 0.000580097619994,
        "ig": 0.0,
        "is": -0.000597891327465,
        "ib": 0.0
      },
      {
        "vd": 2.0,
        "id": 0.00058037952338,
        "ig": 0.0,
        "is": -0.000598183278965,
        "ib": 0.0
      },
      {
        "vd": 2.05,
        "id": 0.000580660183045,
        "ig": 0.0,
        "is": -0.000598473949087,
        "ib": 0.0
      },
      {
        "vd": 2.1,
        "id": 0.000580939760153,
        "ig": 0.0,
        "is": -0.00059876350603,
        "ib": 0.0
      },
      {
        "vd": 2.15,
        "id": 0.000581218392939,
        "ig": 0.0,
        "is": -0.00059905209011,
        "ib": 0.0
      },
      {
        "vd": 2.2,
        "id": 0.000581496194524,
        "ig": 0.0,
        "is": -0.000599339819492,
        "ib": 0.0
      },
      {
        "vd": 2.25,
        "id": 0.000581773264491,
        "ig": 0.0,
        "is": -0.0005996267947,
        "ib": 0.0
      },
      {
        "vd": 2.3,
        "id": 0.00058204968364,
        "ig": 0.0,
        "is": -0.000599913102269,
        "ib": 0.0
      },
      {
        "vd": 2.35,
        "id": 0.000582325528403,
        "ig": 0.0,
        "is": -0.000600198817789,
        "ib": 0.0
      },
      {
        "vd": 2.4,
        "id": 0.000582600862111,
        "ig": 0.0,
        "is": -0.000600484008543,
        "ib": 0.0
      },
      {
        "vd": 2.45,
        "id": 0.000582875745037,
        "ig": 0.0,
        "is": -0.000600768735875,
        "ib": 0.0
      },
      {
        "vd": 2.5,
        "id": 0.000583150232647,
        "ig": 0.0,
        "is": -0.000601053057407,
        "ib": 0.0
      }
    ]
  },
  {
    "index": 4,
    "vars": {
      "vb": -2.5,
      "vs": 0.0,
      "vg": 2.2684
    },
    "columns": [
      "vd",
      "id",
      "ig",
      "is",
      "ib"
    ],
    "data": [
      {
        "vd": 0.0,
        "id": 9.60612038473e-15,
        "ig": 0.0,
        "is": 9.90105332032e-15,
        "ib": 0.0
      },
      {
        "vd": 0.05,
        "id": 7.39170930988e-05,
        "ig": 0.0,
        "is": -7.61867189297e-05,
        "ib": 0.0
      },
      {
        "vd": 0.1,
        "id": 0.000144388586098,
        "ig": 0.0,
        "is": -0.00014882238906,
        "ib": 0.0
      },
      {
        "vd": 0.15,
        "id": 0.000211424570171,
        "ig": 0.0,
        "is": -0.000217917386478,
        "ib": 0.0
      },
      {
        "vd": 0.2,
        "id": 0.000275035145179,
        "ig": 0.0,
        "is": -0.000283482096459,
        "ib": 0.0
      },
      {
        "vd": 0.25,
        "id": 0.000335230435736,
        "ig": 0.0,
        "is": -0.0003455269297,
        "ib": 0.0
      },
      {
        "vd": 0.3,
        "id": 0.000392020613205,
        "ig": 0.0,
        "is": -0.000404062345103,
        "ib": 0.0
      },
      {
        "vd": 0.35,
        "id": 0.000445415926584,
        "ig": 0.0,
        "is": -0.0004590988823,
        "ib": 0.0
      },
      {
        "vd": 0.4,
        "id": 0.000495426749804,
        "ig": 0.0,
        "is": -0.00051064720893,
        "ib": 0.0
      },
      {
        "vd": 0.45,
        "id": 0.000542063648387,
        "ig": 0.0,
        "is": -0.000558718190795,
        "ib": 0.0
      },
      {
        "vd": 0.5,
        "id": 0.000585337483403,
        "ig": 0.0,
        "is": -0.000603322998205,
        "ib": 0.0
      },
      {
        "vd": 0.55,
        "id": 0.000625259571089,
        "ig": 0.0,
        "is": -0.00064447327105,
        "ib": 0.0
      },
      {
        "vd": 0.6,
        "id": 0.000661841938975,
        "ig": 0.0,
        "is": -0.000682181381672,
        "ib": 0.0
      },
      {
        "vd": 0.65,
        "id": 0.000695097741626,
        "ig": 0.0,
        "is": -0.000716460865208,
        "ib": 0.0
      },
      {
        "vd": 0.7,
        "id": 0.000725041966132,
        "ig": 0.0,
        "is": -0.00074732714525,
        "ib": 0.0
      },
      {
        "vd": 0.75,
        "id": 0.000751692656297,
        "ig": 0.0,
        "is": -0.000774798795963,
        "ib": 0.0
      },
      {
        "vd": 0.8,
        "id": 0.00077507310837,
        "ig": 0.0,
        "is": -0.000798899806372,
        "ib": 0.0
      },
      {
        "vd": 0.85,
        "id": 0.000795215925924,
        "ig": 0.0,
        "is": -0.000819663758383,
        "ib": 0.0
      },
      {
        "vd": 0.9,
        "id": 0.000812170642239,
        "ig": 0.0,
        "is": -0.000837141684986,
        "ib": 0.0
      },
      {
        "vd": 0.95,
        "id": 0.000826018027664,
        "ig": 0.0,
        "is": -0.000851416816696,
        "ib": 0.0
      },
      {
        "vd": 1.0,
        "id": 0.000836895648673,
        "ig": 0.0,
        "is": -0.000862630928088,
        "ib": 0.0
      },
      {
        "vd": 1.05,
        "id": 0.000845037145697,
        "ig": 0.0,
        "is": -0.000871024822928,
        "ib": 0.0
      },
      {
        "vd": 1.1,
        "id": 0.000850812249369,
        "ig": 0.0,
        "is": -0.000876979584021,
        "ib": 0.0
      },
      {
        "vd": 1.15,
        "id": 0.000854723824639,
        "ig": 0.0,
        "is": -0.000881013525744,
        "ib": 0.0
      },
      {
        "vd": 1.2,
        "id": 0.000857321717852,
        "ig": 0.0,
        "is": -0.000883693394803,
        "ib": 0.0
      },
      {
        "vd": 1.25,
        "id": 0.000859079387653,
        "ig": 0.0,
        "is": -0.00088550720518,
        "ib": 0.0
      },
      {
        "vd": 1.3,
        "id": 0.000860329599304,
        "ig": 0.0,
        "is": -0.00088679795398,
        "ib": 0.0
      },
      {
        "vd": 1.35,
        "id": 0.000861277307486,
        "ig": 0.0,
        "is": -0.000887776897886,
        "ib": 0.0
      },
      {
        "vd": 1.4,
        "id": 0.00086204136673,
        "ig": 0.0,
        "is": -0.000888566546115,
        "ib": 0.0
      },
      {
        "vd": 1.45,
        "id": 0.000862690080982,
        "ig": 0.0,
        "is": -0.000889237304309,
        "ib": 0.0
      },
      {
        "vd": 1.5,
        "id": 0.000863263480204,
        "ig": 0.0,
        "is": -0.000889830432238,
        "ib": 0.0
      },
      {
        "vd": 1.55,
        "id": 0.000863785789832,
        "ig": 0.0,
        "is": -0.000890370901525,
        "ib": 0.0
      },
      {
        "vd": 1.6,
        "id": 0.000864272211919,
        "ig": 0.0,
        "is": -0.000890874380483,
        "ib": 0.0
      },
      {
        "vd": 1.65,
        "id": 0.000864732627512,
        "ig": 0.0,
        "is": -0.000891351055289,
        "ib": 0.0
      },
      {
        "vd": 1.7,
        "id": 0.000865173677979,
        "ig": 0.0,
        "is": -0.00089180777062,
        "ib": 0.0
      },
      {
        "vd": 1.75,
        "id": 0.000865599960481,
        "ig": 0.0,
        "is": -0.000892249265727,
        "ib": 0.0
      },
      {
        "vd": 1.8,
        "id": 0.000866014745045,
        "ig": 0.0,
        "is": -0.000892678911308,
        "ib": 0.0
      },
      {
        "vd": 1.85,
        "id": 0.000866420414751,
        "ig": 0.0,
        "is": -0.000893099162698,
        "ib": 0.0
      },
      {
        "vd": 1.9,
        "id": 0.0008668187413,
        "ig": 0.0,
        "is": -0.00089351184689,
        "ib": 0.0
      },
      {
        "vd": 1.95,
        "id": 0.000867211068205,
        "ig": 0.0,
        "is": -0.000893918349325,
        "ib": 0.0
      },
      {
        "vd": 2.0,
        "id": 0.000867598433505,
        "ig": 0.0,
        "is": -0.000894319738521,
        "ib": 0.0
      },
      {
        "vd": 2.05,
        "id": 0.00086798164772,
        "ig": 0.0,
        "is": -0.00089471685114,
        "ib": 0.0
      },
      {
        "vd": 2.1,
        "id": 0.000868361356731,
        "ig": 0.0,
        "is": -0.000895110351276,
        "ib": 0.0
      },
      {
        "vd": 2.15,
        "id": 0.000868738075191,
        "ig": 0.0,
        "is": -0.000895500772561,
        "ib": 0.0
      },
      {
        "vd": 2.2,
        "id": 0.000869112227137,
        "ig": 0.0,
        "is": -0.0008958885486,
        "ib": 0.0
      },
      {
        "vd": 2.25,
        "id": 0.000869484156692,
        "ig": 0.0,
        "is": -0.000896274035327,
        "ib": 0.0
      },
      {
        "vd": 2.3,
        "id": 0.000869854148583,
        "ig": 0.0,
        "is": -0.000896657527697,
        "ib": 0.0
      },
      {
        "vd": 2.35,
        "id": 0.000870222442997,
        "ig": 0.0,
        "is": -0.000897039272328,
        "ib": 0.0
      },
      {
        "vd": 2.4,
        "id": 0.000870589244311,
        "ig": 0.0,
        "is": -0.000897419477256,
        "ib": 0.0
      },
      {
        "vd": 2.45,
        "id": 0.000870954719344,
        "ig": 0.0,
        "is": -0.000897798319603,
        "ib": 0.0
      },
      {
        "vd": 2.5,
        "id": 0.000871319020504,
        "ig": 0.0,
        "is": -0.000898175951734,
        "ib": 0.0
      }
    ]
  },
  {
    "index": 5,
    "vars": {
      "vb": -2.5,
      "vs": 0.0,
      "vg": 2.5
    },
    "columns": [
      "vd",
      "id",
      "ig",
      "is",
      "ib"
    ],
    "data": [
      {
        "vd": 0.0,
        "id": 9.60489132238e-15,
        "ig": 0.0,
        "is": 9.90096899925e-15,
        "ib": 0.0
      },
      {
        "vd": 0.05,
        "id": 8.60670557929e-05,
        "ig": 0.0,
        "is": -8.87203424066e-05,
        "ib": 0.0
      },
      {
        "vd": 0.1,
        "id": 0.000168777588354,
        "ig": 0.0,
        "is": -0.000173981093728,
        "ib": 0.0
      },
      {
        "vd": 0.15,
        "id": 0.000248140971244,
        "ig": 0.0,
        "is": -0.000255791892251,
        "ib": 0.0
      },
      {
        "vd": 0.2,
        "id": 0.000324166564284,
        "ig": 0.0,
        "is": -0.000334162362107,
        "ib": 0.0
      },
      {
        "vd": 0.25,
        "id": 0.000396863719057,
        "ig": 0.0,
        "is": -0.000409102119024,
        "ib": 0.0
      },
      {
        "vd": 0.3,
        "id": 0.000466241785904,
        "ig": 0.0,
        "is": -0.000480620777916,
        "ib": 0.0
      },
      {
        "vd": 0.35,
        "id": 0.00053231012476,
        "ig": 0.0,
        "is": -0.000548727962999,
        "ib": 0.0
      },
      {
        "vd": 0.4,
        "id": 0.000595078117194,
        "ig": 0.0,
        "is": -0.000613433321457,
        "ib": 0.0
      },
      {
        "vd": 0.45,
        "id": 0.000654555185423,
        "ig": 0.0,
        "is": -0.000674746542176,
        "ib": 0.0
      },
      {
        "vd": 0.5,
        "id": 0.000710750817289,
        "ig": 0.0,
        "is": -0.000732677381802,
        "ib": 0.0
      },
      {
        "vd": 0.55,
        "id": 0.000763674601735,
        "ig": 0.0,
        "is": -0.000787235701568,
        "ib": 0.0
      },
      {
        "vd": 0.6,
        "id": 0.000813336281037,
        "ig": 0.0,
        "is": -0.000838431520245,
        "ib": 0.0
      },
      {
        "vd": 0.65,
        "id": 0.000859745824546,
        "ig": 0.0,
        "is": -0.000886275091677,
        "ib": 0.0
      },
      {
        "vd": 0.7,
        "id": 0.000902913542703,
        "ig": 0.0,
        "is": -0.000930777020586,
        "ib": 0.0
      },
      {
        "vd": 0.75,
        "id": 0.000942850257059,
        "ig": 0.0,
        "is": -0.000971948439261,
        "ib": 0.0
      },
      {
        "vd": 0.8,
        "id": 0.000979567568702,
        "ig": 0.0,
        "is": -0.00100980128338,
        "ib": 0.0
      },
      {
        "vd": 0.85,
        "id": 0.00101307828595,
        "ig": 0.0,
        "is": -0.00104434873322,
        "ib": 0.0
      },
      {
        "vd": 0.9,
        "id": 0.00104339712678,
        "ig": 0.0,
        "is": -0.00107560593778,
        "ib": 0.0
      },
      {
        "vd": 0.95,
        "id": 0.00107054190238,
        "ig": 0.0,
        "is": -0.00110359123494,
        "ib": 0.0
      },
      {
        "vd": 1.0,
        "id": 0.00109453556256,
        "ig": 0.0,
        "is": -0.00112832826033,
        "ib": 0.0
      },
      {
        "vd": 1.05,
        "id": 0.00111540981015,
        "ig": 0.0,
        "is": -0.00114984967308,
        "ib": 0.0
      },
      {
        "vd": 1.1,
        "id": 0.00113321156951,
        "ig": 0.0,
        "is": -0.00116820382329,
        "ib": 0.0
      },
      {
        "vd": 1.15,
        "id": 0.00114801448317,
        "ig": 0.0,
        "is": -0.00118346660525,
        "ib": 0.0
      },
      {
        "vd": 1.2,
        "id": 0.00115993842541,
        "ig": 0.0,
        "is": -0.00119576157436,
        "ib": 0.0
      },
      {
        "vd": 1.25,
        "id": 0.00116917863698,
        "ig": 0.0,
        "is": -0.00120528998066,
        "ib": 0.0
      },
      {
        "vd": 1.3,
        "id": 0.00117603724953,
        "ig": 0.0,
        "is": -0.00121236326848,
        "ib": 0.0
      },
      {
        "vd": 1.35,
        "id": 0.00118093128681,
        "ig": 0.0,
        "is": -0.00121741132694,
        "ib": 0.0
      },
      {
        "vd": 1.4,
        "id": 0.00118434504436,
        "ig": 0.0,
        "is": -0.00122093339781,
        "ib": 0.0
      },
      {
        "vd": 1.45,
        "id": 0.00118673776659,
        "ig": 0.0,
        "is": -0.00122340290501,
        "ib": 0.0
      },
      {
        "vd": 1.5,
        "id": 0.00118846962126,
        "ig": 0.0,
        "is": -0.00122519113634,
        "ib": 0.0
      },
      {
        "vd": 1.55,
        "id": 0.00118978566874,
        "ig": 0.0,
        "is": -0.00122655072013,
        "ib": 0.0
      },
      {
        "vd": 1.6,
        "id": 0.00119083948128,
        "ig": 0.0,
        "is": -0.00122763997168,
        "ib": 0.0
      },
      {
        "vd": 1.65,
        "id": 0.00119172430177,
        "ig": 0.0,
        "is": -0.00122855501321,
        "ib": 0.0
      },
      {
        "vd": 1.7,
        "id": 0.00119249684298,
        "ig": 0.0,
        "is": -0.00122935430977,
        "ib": 0.0
      },
      {
        "vd": 1.75,
        "id": 0.00119319229633,
        "ig": 0.0,
        "is": -0.00123007413923,
        "ib": 0.0
      },
      {
        "vd": 1.8,
        "id": 0.00119383311968,
        "ig": 0.0,
        "is": -0.00123073765298,
        "ib": 0.0
      },
      {
        "vd": 1.85,
        "id": 0.00119443408616,
        "ig": 0.0,
        "is": -0.00123136008182,
        "ib": 0.0
      },
      {
        "vd": 1.9,
        "id": 0.00119500521212,
        "ig": 0.0,
        "is": -0.00123195174923,
        "ib": 0.0
      },
      {
        "vd": 1.95,
        "id": 0.0011955534762,
        "ig": 0.0,
        "is": -0.00123251985062,
        "ib": 0.0
      },
      {
        "vd": 2.0,
        "id": 0.0011960838679,
        "ig": 0.0,
        "is": -0.00123306953075,
        "ib": 0.0
      },
      {
        "vd": 2.05,
        "id": 0.00119660004061,
        "ig": 0.0,
        "is": -0.00123360455376,
        "ib": 0.0
      },
      {
        "vd": 2.1,
        "id": 0.0011971047194,
        "ig": 0.0,
        "is": -0.00123412773125,
        "ib": 0.0
      },
      {
        "vd": 2.15,
        "id": 0.00119759998204,
        "ig": 0.0,
        "is": -0.00123464120253,
        "ib": 0.0
      },
      {
        "vd": 2.2,
        "id": 0.00119808743231,
        "ig": 0.0,
        "is": -0.00123514662264,
        "ib": 0.0
      },
      {
        "vd": 2.25,
        "id": 0.00119856833211,
        "ig": 0.0,
        "is": -0.00123564529118,
        "ib": 0.0
      },
      {
        "vd": 2.3,
        "id": 0.0011990436831,
        "ig": 0.0,
        "is": -0.00123613824244,
        "ib": 0.0
      },
      {
        "vd": 2.35,
        "id": 0.00119951429349,
        "ig": 0.0,
        "is": -0.00123662630962,
        "ib": 0.0
      },
      {
        "vd": 2.4,
        "id": 0.00119998082393,
        "ig": 0.0,
        "is": -0.0012371101713,
        "ib": 0.0
      },
      {
        "vd": 2.45,
        "id": 0.00120044381322,
        "ig": 0.0,
        "is": -0.00123759038577,
        "ib": 0.0
      },
      {
        "vd": 2.5,
        "id": 0.00120090371331,
        "ig": 0.0,
        "is": -0.00123806741656,
        "ib": 0.0
      }
    ]
  }
];
        const inputs = ["vb         V  B GROUND SMU4 0.1 CON        -2.5", "vs         V  S GROUND SMU3 0.1 CON        0", "vg         V  G GROUND SMU2 0.1 LIN        2    1.342      2.5        6    0.2316", "vd         V  D GROUND SMU1 0.1 LIN        1    0          2.5        51   0.05"];
        const outputs = ["id         I  D GROUND SMU1 B", "ig         I  G GROUND GND B", "is         I  S GROUND GND B", "ib         I  B GROUND GND B"];
        const values = {"DataOrigin": "Simulation", "___CONTEXT": "", "Date": "Jul 5 Tue 09:33:13 2016", "Version": "WaferPro.2016.04", "Bench": "WX-ABench", "Temperature": "27", "Lot": "MyLotA_02", "Wafer": "Wafer_1", "Die": "X-1-Y-1", "DieList": "WX_TargetDies_1", "Block": "WholeDie", "Subsite": "Subsite_1", "Routine": "WPro_MOSFET_DC", "MeasCond": "WX_DC_MeasGroup1", "Device": "1", "DeviceName": "Device_1", "DevTechno": "MOSFET", "DevPolarity": "N", "Setup": "IdVd_WBulk", "Type": "1", "___SPICE_INSTANCE": "", "W": "100.000u", "L": "10.0000u", "Nf": " 1.000 ", "___TECHNO_INSTANCE": "", "___CALIBRATION": ""};
        const columns = ["vd", "id", "ig", "is", "ib"];
        const mdmFilename = 'testfile';
        
        // Color palette for plots
        const colors = [
            '#1a73e8', '#34a853', '#ea4335', '#ea8600', 
            '#9334e6', '#e91e63', '#00acc1', '#43a047'
        ];
        
        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            populateInputsTable();
            populateOutputsTable();
            populateMetadata();
            setupControls();
            updatePlot();
            updateDataTable('all');
        });
        
        function parseInputLine(line) {
            const parts = line.trim().split(/\s+/);
            return {
                name: parts[0] || '',
                unit: parts[1] || '',
                terminal: parts[2] || '',
                ground: parts[3] || '',
                source: parts[4] || '',
                compliance: parts[5] || '',
                sweepType: parts[6] || '',
                param1: parts[7] || '',
                param2: parts[8] || '',
                param3: parts[9] || '',
                param4: parts[10] || '',
                param5: parts[11] || ''
            };
        }
        
        function parseOutputLine(line) {
            const parts = line.trim().split(/\s+/);
            return {
                name: parts[0] || '',
                unit: parts[1] || '',
                terminal: parts[2] || '',
                ground: parts[3] || '',
                source: parts[4] || '',
                type: parts[5] || ''
            };
        }
        
        function parseInputWithOrder(line) {
            const input = parseInputLine(line);
            let sweepOrder = Infinity; // CON goes to end
            let sweepLabel = '';
            let sweepOption = '';
            
            if (input.sweepType === 'CON') {
                sweepLabel = 'CON';
                sweepOption = input.param1;
            } else if (input.sweepType) {
                // For LIN, LOG, etc. - param1 is the sweep order
                sweepOrder = parseInt(input.param1) || Infinity;
                sweepLabel = `VAR${input.param1}`;
                sweepOption = `${input.sweepType}: ${input.param2}  ${input.param3} (${input.param4} pts, step ${input.param5})`;
            }
            
            return { ...input, sweepOrder, sweepLabel, sweepOption, originalLine: line };
        }
        
        // Parse and sort inputs by sweep order
        const parsedInputs = inputs.map(parseInputWithOrder).sort((a, b) => a.sweepOrder - b.sweepOrder);
        
        function populateInputsTable() {
            const tbody = document.getElementById('inputs-table');
            parsedInputs.forEach(input => {
                tbody.innerHTML += `
                    <tr>
                        <td><span class="var-name">${input.name}</span></td>
                        <td><span class="var-unit">${input.unit}</span></td>
                        <td><span class="var-node">${input.terminal}</span></td>
                        <td><span class="var-smu">${input.source}</span></td>
                        <td><span class="var-sweep">${input.sweepLabel}</span></td>
                        <td><span class="var-sweep">${input.sweepOption}</span></td>
                    </tr>
                `;
            });
        }
        
        function populateOutputsTable() {
            const tbody = document.getElementById('outputs-table');
            
            // Get node order from sorted inputs
            const nodeOrder = parsedInputs.map(inp => inp.terminal);
            
            // Parse and sort outputs by node order (same as inputs)
            const parsedOutputs = outputs.map(line => parseOutputLine(line));
            parsedOutputs.sort((a, b) => {
                const orderA = nodeOrder.indexOf(a.terminal);
                const orderB = nodeOrder.indexOf(b.terminal);
                // If node not found in inputs, put at end
                return (orderA === -1 ? 999 : orderA) - (orderB === -1 ? 999 : orderB);
            });
            
            parsedOutputs.forEach(output => {
                tbody.innerHTML += `
                    <tr>
                        <td><span class="var-name">${output.name}</span></td>
                        <td><span class="var-unit">${output.unit}</span></td>
                        <td><span class="var-node">${output.terminal}</span></td>
                        <td><span class="var-smu">${output.source}</span></td>
                        <td><span class="var-sweep">${output.type || ''}</span></td>
                    </tr>
                `;
            });
        }
        
        function populateMetadata() {
            const grid = document.getElementById('metadata-grid');
            const displayKeys = ['Date', 'Lot', 'Wafer', 'Die', 'Subsite', 'DeviceName', 
                                 'DevTechno', 'DevPolarity', 'Setup', 'W', 'L', 'Temperature'];
            
            displayKeys.forEach(key => {
                if (values[key]) {
                    grid.innerHTML += `
                        <div class="metadata-item">
                            <span class="metadata-label">${key}:</span>
                            <span class="metadata-value">${values[key]}</span>
                        </div>
                    `;
                }
            });
        }
        
        function setupControls() {
            // X-axis selector
            const xSelect = document.getElementById('x-axis-select');
            columns.forEach(col => {
                const option = document.createElement('option');
                option.value = col;
                option.textContent = col;
                xSelect.appendChild(option);
            });
            xSelect.addEventListener('change', updatePlot);
            
            // Y-axis checkboxes (outputs)
            const yCheckboxes = document.getElementById('y-axis-checkboxes');
            const outputNames = outputs.map(line => parseOutputLine(line).name);
            
            outputNames.forEach((name, idx) => {
                const div = document.createElement('div');
                div.className = 'checkbox-item';
                div.innerHTML = `
                    <input type="checkbox" id="y-${name}" value="${name}" ${idx === 0 ? 'checked' : ''}>
                    <label for="y-${name}">${name}</label>
                `;
                yCheckboxes.appendChild(div);
            });
            yCheckboxes.querySelectorAll('input').forEach(cb => {
                cb.addEventListener('change', updatePlot);
            });
            
            // Block selector for plot
            const blockSelect = document.getElementById('block-select');
            mdmData.forEach((block, idx) => {
                const vars = Object.entries(block.vars).map(([k, v]) => `${k}=${v}`).join(', ');
                const option = document.createElement('option');
                option.value = idx;
                option.textContent = vars;
                blockSelect.appendChild(option);
            });
            blockSelect.addEventListener('change', updatePlot);
            
            // Table block selector
            const tableBlockSelect = document.getElementById('table-block-select');
            tableBlockSelect.innerHTML = '<option value="all">All</option>';
            mdmData.forEach((block, idx) => {
                const vars = Object.entries(block.vars).map(([k, v]) => `${k}=${v}`).join(', ');
                const option = document.createElement('option');
                option.value = idx;
                option.textContent = vars;
                tableBlockSelect.appendChild(option);
            });
            tableBlockSelect.addEventListener('change', (e) => updateDataTable(e.target.value));
            
            // X scale buttons
            document.querySelectorAll('#x-scale-btns .plot-type-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('#x-scale-btns .plot-type-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    updatePlot();
                });
            });
            
            // Y scale buttons
            document.querySelectorAll('#y-scale-btns .plot-type-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('#y-scale-btns .plot-type-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    updatePlot();
                });
            });
            
            // Save plot button
            document.getElementById('save-plot-btn').addEventListener('click', savePlotAsPNG);
            
            // Copy table button
            document.getElementById('copy-table-btn').addEventListener('click', () => copyTableToClipboard('table-head', 'table-body'));
        }
        
        function updatePlot() {
            const xAxis = document.getElementById('x-axis-select').value;
            const yAxes = Array.from(document.querySelectorAll('#y-axis-checkboxes input:checked')).map(cb => cb.value);
            const blockValue = document.getElementById('block-select').value;
            const xScale = document.querySelector('#x-scale-btns .plot-type-btn.active').dataset.scale;
            const yScale = document.querySelector('#y-scale-btns .plot-type-btn.active').dataset.scale;
            
            const traces = [];
            let colorIdx = 0;
            
            const blocksToPlot = blockValue === 'all' ? mdmData : [mdmData[parseInt(blockValue)]];
            
            blocksToPlot.forEach((block, blockIdx) => {
                const varLabel = Object.entries(block.vars).map(([k, v]) => `${k}=${v}`).join(', ');
                
                yAxes.forEach(yAxis => {
                    let xData = block.data.map(row => row[xAxis]);
                    let yData = block.data.map(row => row[yAxis]);
                    
                    // Handle negative values for log scale
                    if (xScale === 'log') {
                        xData = xData.map(v => Math.abs(v));
                    }
                    if (yScale === 'log') {
                        yData = yData.map(v => Math.abs(v));
                    }
                    
                    traces.push({
                        x: xData,
                        y: yData,
                        mode: 'lines+markers',
                        name: blockValue === 'all' ? `${yAxis} (${varLabel})` : yAxis,
                        line: { color: colors[colorIdx % colors.length], width: 2 },
                        marker: { size: 4 }
                    });
                    colorIdx++;
                });
            });
            
            // Format axis labels based on scale
            const xAxisLabel = xScale === 'log' ? `log10(${xAxis})` : xAxis;
            const yAxisLabel = yScale === 'log' ? yAxes.map(y => `log10(${y})`).join(', ') : yAxes.join(', ');
            
            // Calculate min/max for axes to ensure max values are shown
            let allX = [];
            let allY = [];
            traces.forEach(trace => {
                allX = allX.concat(trace.x);
                allY = allY.concat(trace.y);
            });
            
            // For linear scale, use actual min/max; for log scale, let Plotly auto-scale
            let xRange, yRange;
            if (xScale === 'linear') {
                const xMin = Math.min(...allX);
                const xMax = Math.max(...allX);
                xRange = [xMin, xMax];
            } else {
                // Log scale: use log10 of positive values for range
                const positiveX = allX.filter(v => v > 0);
                if (positiveX.length > 0) {
                    xRange = [Math.log10(Math.min(...positiveX)), Math.log10(Math.max(...positiveX))];
                } else {
                    xRange = undefined;
                }
            }
            
            if (yScale === 'linear') {
                const yMin = Math.min(...allY);
                const yMax = Math.max(...allY);
                yRange = [yMin, yMax];
            } else {
                // Log scale: use log10 of positive values for range
                const positiveY = allY.filter(v => v > 0);
                if (positiveY.length > 0) {
                    yRange = [Math.log10(Math.min(...positiveY)), Math.log10(Math.max(...positiveY))];
                } else {
                    yRange = undefined;
                }
            }
            
            const layout = {
                title: {
                    text: mdmFilename,
                    font: { size: 16, color: '#202124' },
                    x: 0.01,
                    xanchor: 'left'
                },
                paper_bgcolor: '#ffffff',
                plot_bgcolor: '#ffffff',
                font: { family: 'Inter, Segoe UI, system-ui, sans-serif', color: '#333333', size: 12 },
                xaxis: {
                    title: xAxisLabel,
                    type: xScale,
                    gridcolor: '#eeeeee',
                    zerolinecolor: '#eeeeee',
                    showline: false,
                    minor: {
                        showgrid: true,
                        gridcolor: '#f5f5f5'
                    },
                    exponentformat: 'e',
                    automargin: true,
                    tickmode: 'auto',
                    nticks: 10,
                    showticklabels: true,
                    range: xRange,
                    autorange: xRange === undefined
                },
                yaxis: {
                    title: yAxisLabel,
                    type: yScale,
                    gridcolor: '#eeeeee',
                    zerolinecolor: '#eeeeee',
                    showline: false,
                    minor: {
                        showgrid: true,
                        gridcolor: '#f5f5f5'
                    },
                    exponentformat: 'e',
                    automargin: true,
                    tickmode: 'auto',
                    nticks: 10,
                    showticklabels: true,
                    range: yRange,
                    autorange: yRange === undefined
                },
                legend: {
                    bgcolor: 'rgba(255,255,255,0)',
                    borderwidth: 0
                },
                margin: { t: 60, r: 40, b: 60, l: 80 },
                hovermode: 'closest'
            };
            
            const config = {
                responsive: true,
                displayModeBar: true,
                modeBarButtonsToRemove: ['lasso2d', 'select2d'],
                displaylogo: false
            };
            
            Plotly.newPlot('plot', traces, layout, config);
        }
        
        // Helper to get sweep order for a variable name
        function getSweepOrder(varName) {
            const input = parsedInputs.find(inp => inp.name === varName);
            return input ? input.sweepOrder : Infinity;
        }
        
        // Check if a column is an input variable
        function isInputVar(varName) {
            return parsedInputs.some(inp => inp.name === varName);
        }
        
        // Get output variable names
        const outputNames = outputs.map(line => parseOutputLine(line).name);
        
        function updateDataTable(blockValue) {
            const thead = document.getElementById('table-head');
            const tbody = document.getElementById('table-body');
            
            if (blockValue === 'all') {
                // Show all data combined
                if (mdmData.length === 0) return;
                
                // Get all column names
                const sweepVars = Object.keys(mdmData[0].vars);
                const dataColumns = mdmData[0].columns;
                
                // Combine all columns and separate inputs from outputs
                const allColumns = [...sweepVars, ...dataColumns];
                const inputColumns = allColumns.filter(col => isInputVar(col));
                const outputColumns = allColumns.filter(col => !isInputVar(col));
                
                // Sort input columns by sweep order (ascending, CON at end)
                inputColumns.sort((a, b) => getSweepOrder(a) - getSweepOrder(b));
                
                // Final column order: sorted inputs, then outputs
                const orderedColumns = [...inputColumns, ...outputColumns];
                
                // Header
                thead.innerHTML = '<tr><th>#</th>' + 
                    orderedColumns.map(col => `<th>${col}</th>`).join('') + '</tr>';
                
                // Body: combine all blocks
                let rowNum = 1;
                let rows = '';
                mdmData.forEach(block => {
                    block.data.forEach(row => {
                        const cells = orderedColumns.map(col => {
                            // Check if column is from block.vars or row data
                            const val = block.vars[col] !== undefined ? block.vars[col] : row[col];
                            return `<td>${formatNumber(val)}</td>`;
                        }).join('');
                        rows += `<tr><td>${rowNum++}</td>${cells}</tr>`;
                    });
                });
                tbody.innerHTML = rows;
            } else {
                // Show single block
                const blockIdx = parseInt(blockValue);
                const block = mdmData[blockIdx];
                
                // Get all column names (sweep vars + data columns)
                const sweepVars = Object.keys(block.vars);
                const dataColumns = block.columns;
                
                // Combine all columns and separate inputs from outputs
                const allColumns = [...sweepVars, ...dataColumns];
                const inputColumns = allColumns.filter(col => isInputVar(col));
                const outputColumns = allColumns.filter(col => !isInputVar(col));
                
                // Sort input columns by sweep order
                inputColumns.sort((a, b) => getSweepOrder(a) - getSweepOrder(b));
                
                // Final column order: sorted inputs, then outputs
                const orderedColumns = [...inputColumns, ...outputColumns];
                
                // Header
                thead.innerHTML = '<tr><th>#</th>' + orderedColumns.map(col => `<th>${col}</th>`).join('') + '</tr>';
                
                // Body
                tbody.innerHTML = block.data.map((row, idx) => {
                    const cells = orderedColumns.map(col => {
                        // Check if column is from block.vars or row data
                        const val = block.vars[col] !== undefined ? block.vars[col] : row[col];
                        return `<td>${formatNumber(val)}</td>`;
                    }).join('');
                    return `<tr><td>${idx + 1}</td>${cells}</tr>`;
                }).join('');
            }
        }
        
        function formatNumber(num) {
            if (num === 0) return '0';
            const abs = Math.abs(num);
            if (abs < 1e-12 || abs >= 1e6) {
                return num.toExponential(6);
            }
            return num.toPrecision(6);
        }
        
        function savePlotAsPNG() {
            Plotly.downloadImage('plot', {
                format: 'png',
                width: 1200,
                height: 600,
                filename: mdmFilename
            });
        }
        
        function copyTableToClipboard(theadId, tbodyId) {
            const thead = document.getElementById(theadId);
            const tbody = document.getElementById(tbodyId);
            
            let text = '';
            
            // Header
            const headerCells = thead.querySelectorAll('th');
            text += Array.from(headerCells).map(th => th.textContent).join('\t') + '\n';
            
            // Body
            const rows = tbody.querySelectorAll('tr');
            rows.forEach(row => {
                const cells = row.querySelectorAll('td');
                text += Array.from(cells).map(td => td.textContent).join('\t') + '\n';
            });
            
            navigator.clipboard.writeText(text).then(() => {
                // Find the button that was clicked
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = 'Copied!';
                btn.classList.add('success');
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.classList.remove('success');
                }, 1500);
            });
        }
    </script>
</body>
</html>
